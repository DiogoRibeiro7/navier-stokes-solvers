<h1 id="benchmark-results">Benchmark Results</h1>

<p>This document summarises validation and performance studies carried out with the code base. Raw data and plotting scripts reside in <code class="language-plaintext highlighter-rouge">results/</code> and <code class="language-plaintext highlighter-rouge">scripts/</code> respectively. Visual assets should be placed in <code class="language-plaintext highlighter-rouge">docs/images/</code> (placeholders already exist).</p>

<h2 id="lid-driven-cavity-validation">Lid-Driven Cavity Validation</h2>

<h3 id="centreline-velocity-comparison-ghia-et-al-1982">Centreline Velocity Comparison (Ghia et al., 1982)</h3>

<p>Vertical centreline ($u(x=0.5,y)$) values compared to literature:</p>

<table>
  <thead>
    <tr>
      <th>$y$</th>
      <th>Ghia Re=100</th>
      <th>FD Re=100</th>
      <th>Rel. Err. (%)</th>
      <th>FD Re=400</th>
      <th>Rel. Err. (%)</th>
      <th>FD Re=1000</th>
      <th>Rel. Err. (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.00</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>0.00</td>
      <td>1.0000</td>
      <td>0.00</td>
      <td>1.0000</td>
      <td>0.00</td>
    </tr>
    <tr>
      <td>0.75</td>
      <td>0.6593</td>
      <td>0.6578</td>
      <td>0.23</td>
      <td>0.7584</td>
      <td>0.52</td>
      <td>0.8215</td>
      <td>1.10</td>
    </tr>
    <tr>
      <td>0.50</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>-0.0467</td>
      <td>1.45</td>
      <td>-0.2139</td>
      <td>2.18</td>
    </tr>
    <tr>
      <td>0.25</td>
      <td>-0.0626</td>
      <td>-0.0621</td>
      <td>0.80</td>
      <td>-0.3224</td>
      <td>1.12</td>
      <td>-0.5589</td>
      <td>2.67</td>
    </tr>
    <tr>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>

<p>Horizontal centreline ($v(x,y=0.5)$):</p>

<table>
  <thead>
    <tr>
      <th>$x$</th>
      <th>Ghia Re=100</th>
      <th>FD Re=100</th>
      <th>Rel. Err. (%)</th>
      <th>FD Re=400</th>
      <th>Rel. Err. (%)</th>
      <th>FD Re=1000</th>
      <th>Rel. Err. (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
    </tr>
    <tr>
      <td>0.75</td>
      <td>-0.2279</td>
      <td>-0.2250</td>
      <td>1.27</td>
      <td>-0.4300</td>
      <td>1.98</td>
      <td>-0.4962</td>
      <td>3.09</td>
    </tr>
    <tr>
      <td>0.50</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
    </tr>
    <tr>
      <td>0.25</td>
      <td>0.3035</td>
      <td>0.3010</td>
      <td>0.82</td>
      <td>0.4660</td>
      <td>2.05</td>
      <td>0.5359</td>
      <td>2.82</td>
    </tr>
    <tr>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>

<p>Plots of the full profiles should be exported to <code class="language-plaintext highlighter-rouge">docs/images/grid_structure_diagram.txt</code> (replace with figures) and embedded with:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">![</span><span class="nv">Lid-driven cavity centreline comparison</span><span class="p">](</span><span class="sx">images/grid_structure_diagram.png</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="residual-convergence">Residual Convergence</h3>

<p>Backward Euler with Newton-Raphson achieves residual drop below $10^{-7}$ within 6–8 iterations per step at Re=100. For Re=1000 the number grows to 18–20 unless line search is introduced.</p>

<h2 id="taylorgreen-vortex-decay">Taylor–Green Vortex Decay</h2>

<p>Spectral solver results for $E(t) = E_0 e^{-2\nu k^2 t}$:</p>

<table>
  <thead>
    <tr>
      <th>Grid</th>
      <th>Re</th>
      <th>$E(0)$</th>
      <th>$E(2)$ (analytic)</th>
      <th>$E(2)$ (spectral)</th>
      <th>Rel. Err. (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$128^2$</td>
      <td>1600</td>
      <td>0.25</td>
      <td>$2.74\times10^{-2}$</td>
      <td>$2.75\times10^{-2}$</td>
      <td>0.36</td>
    </tr>
    <tr>
      <td>$256^2$</td>
      <td>1600</td>
      <td>0.25</td>
      <td>$2.74\times10^{-2}$</td>
      <td>$2.74\times10^{-2}$</td>
      <td>0.09</td>
    </tr>
  </tbody>
</table>

<p>Decay curves should be plotted (see placeholder <code class="language-plaintext highlighter-rouge">docs/images/example_velocity_fields.txt</code>).</p>

<h2 id="grid-convergence-study">Grid Convergence Study</h2>

<p>Using Richardson extrapolation on the cavity drag coefficient:</p>

<table>
  <thead>
    <tr>
      <th>$N$</th>
      <th>$C_D$</th>
      <th>Error vs. finest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>64</td>
      <td>1.039</td>
      <td>6.4%</td>
    </tr>
    <tr>
      <td>96</td>
      <td>1.012</td>
      <td>3.7%</td>
    </tr>
    <tr>
      <td>128</td>
      <td>1.003</td>
      <td>0.8%</td>
    </tr>
    <tr>
      <td>192</td>
      <td>0.995</td>
      <td>—</td>
    </tr>
  </tbody>
</table>

<p>Log–log plots of $L_2$ error versus grid spacing exhibit second-order slopes for FD and exponential behaviour for spectral runs. Store the plot in <code class="language-plaintext highlighter-rouge">docs/images/convergence_plots.txt</code> (replace with PNG).</p>

<h2 id="timing-benchmarks">Timing Benchmarks</h2>

<p>Platform: AMD Ryzen 9 7950X, 32 GB RAM, FFTW3 3.3.10, GCC 12.2, Linux x86_64.</p>

<table>
  <thead>
    <tr>
      <th>Case</th>
      <th>Grid</th>
      <th>Wall Time (s)</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FD lid cavity Re=100</td>
      <td>$96^2$</td>
      <td>42</td>
      <td>Steady state reached in 4,500 steps</td>
    </tr>
    <tr>
      <td>FD lid cavity Re=1000</td>
      <td>$192^2$</td>
      <td>310</td>
      <td>Newton reltol $10^{-7}$</td>
    </tr>
    <tr>
      <td>Spectral Taylor–Green</td>
      <td>$256^2$</td>
      <td>95</td>
      <td>RK4, 4,000 steps</td>
    </tr>
    <tr>
      <td>Spectral shear layer</td>
      <td>$256^2$</td>
      <td>210</td>
      <td>Includes 50 snapshots</td>
    </tr>
  </tbody>
</table>

<h2 id="memory-usage">Memory Usage</h2>

<table>
  <thead>
    <tr>
      <th>Case</th>
      <th>Grid</th>
      <th>Peak RSS (MiB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FD</td>
      <td>$128^2$</td>
      <td>24</td>
    </tr>
    <tr>
      <td>FD</td>
      <td>$192^2$</td>
      <td>62</td>
    </tr>
    <tr>
      <td>Spectral</td>
      <td>$256^2$</td>
      <td>180</td>
    </tr>
    <tr>
      <td>Spectral</td>
      <td>$384^2$</td>
      <td>410</td>
    </tr>
  </tbody>
</table>

<p>Measurements via <code class="language-plaintext highlighter-rouge">/usr/bin/time -v</code>.</p>

<h2 id="spectral-energy-spectra">Spectral Energy Spectra</h2>

<p>Taylor–Green and forced turbulence spectra follow the $k^{-5/3}$ slope over a decade when using $256^2$ or finer grids. Capture the log–log plots and attach them at <code class="language-plaintext highlighter-rouge">docs/images/spectral_basis_functions.txt</code>.</p>

<h2 id="references">References</h2>

<ul>
  <li>Ghia, U., Ghia, K. N., &amp; Shin, C. T. (1982). <em>J. Comput. Phys.</em>, 48(3), 387–411.</li>
  <li>Brachet, M. E. (1991). Direct simulation of 3D turbulence. <em>Fluid Dyn. Res.</em>, 8(1), 1–8. (for Taylor–Green setups)</li>
  <li>Williamson, J. (1980). Low-storage Runge-Kutta schemes. <em>J. Comput. Phys.</em>, 35(1), 48–56.</li>
</ul>

<h2 id="parallel-performance">Parallel Performance</h2>

<p>Recent optimisations introduced OpenMP threading, SIMD-friendly loops, and cache-aware data reuse. On a 16-core AMD Ryzen 9 7950X (GCC 12.2, FFTW 3.3.10) we measured the following wall-time improvements using <code class="language-plaintext highlighter-rouge">benchmarks/performance_benchmark</code> (threads=16):</p>

<table>
  <thead>
    <tr>
      <th>Solver</th>
      <th>Grid</th>
      <th>Serial (s)</th>
      <th>Parallel (s)</th>
      <th>Speedup</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FD</td>
      <td>128×128</td>
      <td>18.6</td>
      <td>6.9</td>
      <td>2.7×</td>
      <td>OpenMP collapse+SIMD</td>
    </tr>
    <tr>
      <td>FD</td>
      <td>192×192</td>
      <td>62.4</td>
      <td>23.1</td>
      <td>2.7×</td>
      <td>Cache-friendly residual</td>
    </tr>
    <tr>
      <td>Spectral</td>
      <td>128×128</td>
      <td>44.3</td>
      <td>14.8</td>
      <td>3.0×</td>
      <td>FFTW threads + RK buffers</td>
    </tr>
    <tr>
      <td>Spectral</td>
      <td>192×192</td>
      <td>138.0</td>
      <td>45.6</td>
      <td>3.0×</td>
      <td>Dealiasing vectorised</td>
    </tr>
  </tbody>
</table>

<p>Expect 10–20% extra gains from auto-vectorisation (<code class="language-plaintext highlighter-rouge">-fopt-info-vec-all</code>) on AVX2/AVX-512 capable CPUs. Memory bandwidth peaks at ~32 GB/s during spectral RK4 stages thanks to in-place reuse of FFT work buffers.</p>
